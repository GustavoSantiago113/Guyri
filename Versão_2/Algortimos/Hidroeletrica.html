<html>
    <head>
        <title>
            Guyri - Hydroelectric
        </title>
        <link rel="icon" href="Icones/Logotipo 2.png">
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="functions.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    </head>
    <header class="header">
        <img class="logo_header" src="Icones/Logotipo 2.png">
        <div class="title_header">
            <h1 style="background-color: #b5e8c3; font-size: 30px;">ARA</h1>
            <h3 style="background-color: #b5e8c3; font-size: larger;">BIOSYSTEMS</h3>
        </div>
        <a class="return_initial" href="initial_page.html">Home</a>
    </header>
    <body>
    <div class="body_sizing">   
        <div class="main_lateral_dropdown">

            <div class="lateral_dropdown">
                <button class="lateral_dropbtn">
                    <img class="icon" src="Icones/irrigation.png">
                </button>
                <div class="lateral_dropdown-content">
                    <a class="link" href="Gotejamento.html">Dripping</a>
                    <a class="link" href="Aspersao.html">Sprinkling</a>
                    <a class="link" href="Micro_Aspersao.html">Micro-Sprinkling</a>
                    <a class="link" href="Pivo_Central.html">Center Pivot</a>
                </div>
            </div>

            <div class="lateral_dropdown">
                <button class="lateral_dropbtn">
                    <img class="icon" src="Icones/solar-energy.png">
                </button>
                <div class="lateral_dropdown-content">
                    <a class="link" href="Aquecimento_Solar.html">Solar Heating</a>
                    <a class="link" href="Fotovoltaica.html">Photovoltaic</a>
                    <a class="link" href="Eolica.html">Wind</a>
                    <a class="link" href="Hidroeletrica.html">Hydroelectric</a>
                </div>
            </div>

            <div class="lateral_dropdown">
                <button class="lateral_dropbtn">
                    <img class="icon" src="Icones/bacteria.png">
                </button>
                <div class="lateral_dropdown-content">
                    <a class="link" href="Biodigestor.html">Biodigester</a>
                    <a class="link" href="Compostagem.html">Composting</a>
                </div>
            </div>

            <div class="lateral_dropdown">
                <button class="lateral_dropbtn">
                    <img class="icon" src="Icones/greenhouse.png">
                </button>
                <div class="lateral_dropdown-content">
                    <a class="link" href="Ventilacao_Forcada.html">Forced Ventilation</a>
                    <a class="link" href="Ar_Condicionado.html">Air Conditioning</a>
                    <a class="link" href="Nebulizacao.html">Fogging</a>
                </div>
            </div>

            <div class="lateral_dropdown">
                <button class="lateral_dropbtn">
                    <img class="icon" src="Icones/dollar-currency-symbol.png">
                </button>
                <div class="lateral_dropdown-content">
                    <a class="link" href="Analise_Economica.html">Economic analysis</a>
                </div>
            </div>

        </div>

        <div class="main_section">
            <div class="calculator">

                <ul class="nav">
                    <button class="nav_link active" id="esc_bt" onclick="openTab(event, 'esc')">Turbine Choice</button>
                    <button class="nav_link" id="par_turb" style="display: none;">Turbine Parameters</button>
                </ul>

                <div class="tab_content">

                    <div class="tab_pane" id="esc">

                        <input class="input" type="number" step="0.0001" id="H" placeholder="Drop height (m)">
                        <br><input class="input" type="number" step="0.0001" id="Q" placeholder="Drop flow (m3/s)">
                        <br><input class="input" type="number" step="0.0001" id="N" placeholder="Angular speed of rotation (rpm)"> 
                        <br><input class="input" type="number" step="0.0001" id="n" placeholder="Turbine efficiency (%)"> 
                        <br>
                        <button class="result" onclick="mudarParaParametro(event, 'parTurb');">
                            Choose turbine!
                        </button>

                    </div>

                    <div class="tab_pane" id="parTurb" style="display: none;">

                        <div style="background-color: #65b8a6;display: none;" id="fran" class="labelturb">
                            <br><input type="radio" name="turbina" value="turbF" id="turbFrancis">
                            <label for="turbF" style="background-color: #65b8a6; color:black"> Francis</label>
                        </div>
                        <div style="background-color: #65b8a6;display: none;" id="pelt" class="labelturb">
                            <br><input type="radio" name="turbina" value="turbP" id="turbPelton">
                            <label for="turbP" style="background-color: #65b8a6; color:black"> Pelton</label>
                        </div>
                        <div style="background-color: #65b8a6;display: none;" id="kap" class="labelturb">
                            <br><input type="radio" name="turbina" value="turbK" id="turbKaplan">
                            <label for="turbK" style="background-color: #65b8a6; color:black"> Kaplan</label>
                        </div>
                        <div style="background-color: #65b8a6;display: none;" id="micbla" class="labelturb">
                            <br><input type="radio" name="turbina" value="turbMB" id="turbMichellBlank" onclick="MichellBlank();">
                            <label for="turbMB" style="background-color: #65b8a6; color:black"> Michell-Blank</label>
                                <div id='MB_select' style="background-color: #65b8a6;display: none;">
                                    <br><span>Admission angle, considering an injection angle of 16째</span>
                                    <br><input type="radio" name="ang" id="60"/><span>60째</span>
                                    <input type="radio" name="ang" id="90"/><span>90째</span>
                                    <input type="radio" name="ang" id="120"/><span>120째</span>
                                </div>
                        </div>

                        <br>
                        <button class="result" onclick="DimensionarHidroeletrica('divHidroeletrica');" data-bs-toggle="modal" data-bs-target="#exampleModal">
                            Size!
                        </button>

                    </div>

                </div>

            </div>

            <br>
            <br>
        </div>
        <div>

        </div>
    </div>

    <div class="modal fade" id="exampleModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title">Results</h5>
                </div>
                <div class="modal-body">
                    <div id="report">
                        <div class="header_report">
                                <h1 style="background-color: #b5e8c3; font-size: 30px;">ARA</h1>
                                <h3 style="background-color: #b5e8c3; font-size: larger;">BIOSYSTEMS</h3>     
                        </div>
                        <div>
                            <div class="subtitle_report">
                                <h3>Energy</h3>
                                <h4>Hydroelectric</h4>
                            </div>
                            <h5 style="padding-left: 15px;">Inputs</h5>
                            <div class="box_report">
                                <h6 style="background-color: #65b8a6;font-size: 15px;">Turbine Choice</h6>
                                <span>Drop height (m):</span> <span id="HReport"></span>
                                <br><span>Drop flow (m3/s):</span> <span id="QReport"></span>
                                <br><span>Angular speed of rotation (rpm):</span> <span id="NReport"></span>
                                <br><span>Turbine efficiency (%):</span> <span id="nReport"></span>
                            </div>
                            <div id="outputs">
                                <h5 style="padding-left: 15px;">Outputs</h5>
                                <div class="box_report">
                                    <span>Turbine power (kW/h): </span><span id="Pot"></span>
                                    <br><span>Specific speed (rpm): <span id="Ns"></span>
                                    <br><span id="turbReport"></span>
                                    <div class="resultado" id="Francis" style="display: none;background-color: #65b8a6;">
                                        <span>Turbine type: </span><span id="Tdtf"></span>
                                        <br><span>Suction tube diameter (mm): </span><span id="Dtsf"></span>
                                        <br><span>Output speed (m/s): </span><span id="Vsf"></span>
                                        <br><span>Outside diameter of the rotor (mm): </span><span id="Derf"></span>
                                        <br><span>Rotor inner diameter (mm): </span><span id="Dirf"></span>
                                        <br><span>Width of the driving crown (mm): </span><span id="Lcdf"></span>
                                        <br><span>Number of blades: </span><span id="Npf"></span>
                                    </div>
                                    <div class="resultado" id="Pelton" style="display: none;background-color: #65b8a6;">
                                        <span>Number of injector jets: </span><span id="Nji"></span>
                                        <br><span>Injector jet diameter (mm): </span><span id="Djip"></span>
                                        <br><span>Average rotor diameter (mm): </span><span id="Dmrp"></span>
                                        <br><span>Outside diameter of the rotor (mm): </span><span id="Derp"></span>
                                        <br><span>Blade width (mm): </span><span id="Lpp"></span>
                                        <br><span>Blade height (mm): </span><span id="App"></span>
                                        <br><span>Blade Thickness (mm): </span><span id="Epp"></span>
                                        <br><span>Amount of blades: </span><span id="Npp"></span>
                                        <br><span>Steps between blades (mm): </span><span id="Pepp"></span>
                                    </div>
                                    <div class="resultado" id="Kaplan" style="display: none;background-color: #65b8a6;">
                                        <span>Suction tube diameter (mm): </span><span id="Dtsk"></span>
                                        <br><span>output speed (m/s): </span><span id="Vsk"></span>
                                        <br><span>Outside diameter of the rotor (mm): </span><span id="Derk"></span>
                                        <br><span>Rotor inner diameter (mm): </span><span id="Dirk"></span>
                                        <br><span>Average rotor diameter (mm): </span><span id="Dmrk"></span>
                                        <br><span>Spiral box width (mm) </span><span id="Lcek"></span>
                                        <br><span>Amount of blades: </span><span id="Npk"></span>
                                    </div>
                                    <div class="resultado" id="Michell-Blank" style="display: none;background-color: #65b8a6;">
                                        <span>Injector speed (m/s): </span><span id="Vim"></span>
                                        <br><span>Thickness of the injector jet (mm): </span><span id="Ejim"></span>
                                        <br><span>Outside diameter of the rotor (mm): </span><span id="Derm"></span>
                                        <br><span>Rotor inner diameter (mm): </span><span id="Dirm"></span>
                                        <br><span>Injector diameter (mm): </span><span id="Dim"></span>
                                        <br><span>Average rotor diameter (mm): </span><span id="Dmrm"></span>
                                        <br><span>Angular speed of the rotor (rpm): </span><span id="Varm"></span>
                                        <br><span>Tangential speed (m/s): </span><span id="Vtm"></span>
                                        <br><span>Rotor width (mm): </span><span id="Lrm"></span>
                                        <br><span>Amount of blades: </span><span id="Npm"></span>
                                        <br><span>Blade width (mm): </span><span id="Lpm"></span>
                                        <br><span>Blade height (mm): </span><span id="Apm"></span>
                                        <br><span>Blade Thickness (mm): </span><span id="Epm"></span>
                                        <br><span>Steps between blades (mm): </span><span id="Ppm"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="GenerateReport()">Generate Report</button>
                </div>
            </div>
        </div>
    </div>

    </body>
    <script>

        function GenerateReport(){

            const element = document.getElementById('report');
            var opt = {
                filename:     "ARA_Biosystems_Hydroeletric.pdf" ,
                image:        { type: 'jpeg', quality: 1 },
                margin:        [top = 0, left = 0, bottom = 0, right = 0],
                html2canvas:    {height: 2000}
            };

            html2pdf(element, opt)

        }

        var Q = 0;
        var H = 0;
        var N = 0;
        var n = 0;
        var Pot = 0;
        var Ns = 0;
        var turbName;

        function MichellBlank(){
            if (document.getElementById("turbMichellBlank").checked){
                document.getElementById("MB_select").style.display = "block";
            }
            else{
                document.getElementById("MB_select").style.display = "none";
            }
        }

        function mudarParaParametro(evt, tabName){

            Pot = 0;
            Ns = 0;
            Q = parseFloat(document.getElementById('Q').value);
            document.getElementById('QReport').innerHTML = Q;
            H = parseFloat(document.getElementById('H').value);
            document.getElementById('HReport').innerHTML = H;
            N = parseFloat(document.getElementById('N').value);
            document.getElementById('NReport').innerHTML = N;
            n = parseFloat(document.getElementById('n').value);
            document.getElementById('nReport').innerHTML = n;

            Pot = Q * ( n / 100) * 1000 * H * 9.81 ;

            Ns = N * Math.pow(Pot, 0.5) * Math.pow(H, -1.25);

            document.getElementById('Pot').innerHTML = Pot.toFixed(3);
            document.getElementById('Ns').innerHTML = Ns.toFixed(3);

            var i, tab_pane, tab_link, tab_Name;

            tab_pane = document.getElementsByClassName("tab_pane");
            for (i = 0; i < tab_pane.length; i++) {
                tab_pane[i].style.display = "none";
            }

            tab_link = document.getElementsByClassName("nav_link");
            for (i = 0; i < tab_link.length; i++) {
                tab_link[i].className = tab_link[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            document.getElementById('par_turb').style.display = "block";
            document.getElementById('par_turb').className += " active";

            if(H >= 100 && 18 <= Ns && Ns <= 90 ){
                turbName = 'pelt';
                document.getElementById(turbName).style.display = "block";
            }
            else if(H >= 10 && H <= 450 && 70 <= Ns && Ns <= 450 ){
                turbName = 'fran';
                document.getElementById(turbName).style.display = "block";
            }
            else if(H >= 10 && H <= 70 && 250 <= Ns ){
                turbName = 'kap';
                document.getElementById(turbName).style.display = "block";
            }
            else if(H >= 10 && H <= 100 && 30 <= Ns && Ns <= 180 ){
                turbName = 'micbla';
                document.getElementById(turbName).style.display = "block";
            }

            tab_Name = document.getElementsByClassName("turbina");
            for (i = 0; i < tab_Name.length; i++) {
                tab_Name[i].style.display = "none";
            }

        }

        function DimensionarHidroeletrica(el){

            let turbinaNome;
            let tabNome;

            if(document.getElementById("turbPelton").checked){
                turbinaNome = "Pelton";
                document.getElementById('turbReport').innerHTML = "Turbine choosen: Pelton";

                let Nji, Djip, Dmrp, Derp, Lpp, App, Epp, Npp, Pepp;

                if(Ns >= 18 && Ns <= 35){
                    Nji = 1;
                }
                else if(Ns > 35 && Ns <= 50){
                    Nji = 2;
                }
                else if(Ns > 50 && Ns <= 71){
                    Nji = 4;
                }
                else if(Ns > 71 && Ns <= 90){
                    Nji = 6;
                }
                document.getElementById("Nji").innerHTML = Nji.toFixed(3);
                
                Djip = 500*( Math.sqrt( (Q) / (Nji * Math.sqrt(H) ) ) );
                document.getElementById("Djip").innerHTML = Djip.toFixed(3);

                Dmrp = 38 * ( ( 1000 * Math.sqrt( H ) ) / N );
                document.getElementById("Dmrp").innerHTML = Dmrp.toFixed(3);

                App = 3.5 * Djip;
                document.getElementById("App").innerHTML = App.toFixed(3);

                Derp = Dmrp + 2 *( ( 3/5 ) * App);
                document.getElementById("Derp").innerHTML = Derp.toFixed(3);

                Lpp = 3.75 * Djip;
                document.getElementById("Lpp").innerHTML = Lpp.toFixed(3);

                Epp = 1.5 * Djip;
                document.getElementById("Epp").innerHTML = Epp.toFixed(3);

                Npp = ( 1/2 * ( Dmrp / Djip ) ) + 15;
                document.getElementById("Npp").innerHTML = Npp.toFixed(3);

                Pepp = ( Math.PI * Dmrp ) / Npp;
                document.getElementById("Pepp").innerHTML = Pepp.toFixed(3);

            }
            else if(document.getElementById("turbFrancis").checked){
                turbinaNome = "Francis";
                document.getElementById('turbReport').innerHTML = "Turbine choosen: Francis";
                let Tdtf, Dtsf, Vsf, Derf, Dirf, Lcdf, Npf;

                if(71 >= 18 && Ns <= 120){
                    Tdtf = "Slow";
                    Vsf = Math.sqrt( (2 * 9.8 * 0.04 * H ) / 100 );
                    Dtsf = 1000 * Math.sqrt( (4 * Q) / ( Math.PI * Vsf) );
                    Derf = Dtsf * ( 0.4 + ( 94.5 / Ns ) );
                    Dirf = Dtsf * ( 0.96 + 0.00038 * Ns );
                    Lcdf = Derf * ( ( ( ( Ns - 60 ) * 0.07 ) / 65 ) + 0.0995);
                    Npf = 18 - ( ( Ns - 60 ) / 65 );
                }
                else if(Ns > 120 && Ns <= 200){
                    Tdtf = "Normal";
                    Vsf = Math.sqrt( (2 * 9.8 * 0.06 * H ) / 100 );
                    Dtsf = 1000 * Math.sqrt( (4 * Q) / ( Math.PI * Vsf) );
                    Derf = Dtsf * ( 0.4 + ( 94.5 / Ns ) );
                    Dirf = Dtsf * ( 0.96 + 0.00038 * Ns );
                    Lcdf = Derf * ( ( ( ( Ns - 125 ) * 0.15 ) / 100 ) + 0.225);
                    Npf = 17 - ( ( ( Ns - 125 ) * 2 ) / 100 );
                }
                else if(Ns > 200 && Ns <= 300){
                    Tdtf = "Fast";
                    Vsf = Math.sqrt( (2 * 9.8 * 0.12 * H ) / 100 );
                    Dtsf = 1000 * Math.sqrt( (4 * Q) / ( Math.PI * Vsf) );
                    Derf = Dtsf * ( 0.4 + ( 94.5 / Ns ) );
                    Dirf = Dtsf * ( 0.96 + 0.00038 * Ns );
                    Lcdf = Derf * ( ( ( ( Ns - 225 ) * 0.22 ) / 125 ) + 0.2291);
                    Npf = 15 - ( ( ( Ns - 225 ) * 2 ) / 125 );
                }
                else if(Ns > 300 && Ns <= 450){
                    Tdtf = "Super-Fast";
                    Vsf = Math.sqrt( (2 * 9.8 * 0.25 * H ) / 100 );
                    Dtsf = 1000 * Math.sqrt( (4 * Q) / ( Math.PI * Vsf) );
                    Derf = Dtsf * ( 0.4 + ( 94.5 / Ns ) );
                    Dirf = Dtsf * ( 0.96 + 0.00038 * Ns );
                    Lcdf = Derf * ( ( ( ( Ns - 125 ) * 0.19 ) / 100 ) + 0.35);
                    Npf = 3 - ( ( Ns - 350 ) / 100 );
                }

                document.getElementById("Tdtf").innerHTML = Tdtf;
                document.getElementById("Vsf").innerHTML = Vsf.toFixed(3);
                document.getElementById("Dtsf").innerHTML = Dtsf.toFixed(3);
                document.getElementById("Derf").innerHTML = Derf.toFixed(3);
                document.getElementById("Dirf").innerHTML = Dirf.toFixed(3);
                document.getElementById("Lcdf").innerHTML = Lcdf.toFixed(3);
                document.getElementById("Npf").innerHTML = Npf.toFixed(3);

            }
            else if(document.getElementById("turbKaplan").checked){
                turbinaNome = "Kaplan";
                document.getElementById('turbReport').innerHTML = "Turbine choosen: Kaplan";
                let Dtsk, Vsk, Derk, Dirk, Dmrk, Lcek, Npk;

                Vsk = Math.sqrt( (2 * 9.8 * 0.3 * H ) / 100 );
                Dtsk = 1000 * Math.sqrt( (4 * Q) / ( Math.PI * Vsk) );
                document.getElementById("Vsk").innerHTML = Vsk.toFixed(3);
                document.getElementById("Dtsk").innerHTML = Dtsk.toFixed(3);

                Derk = 0.98*Dtsk;
                document.getElementById("Derk").innerHTML = Derk.toFixed(3);

                Dirk = Dtsk * ( 0.25 + ( 94.64 / Ns ) );
                document.getElementById("Dirk").innerHTML = Dirk.toFixed(3);

                Dmrk = Dirk + ( ( Derk - Dirk ) / 2 );
                document.getElementById("Dmrk").innerHTML = Dmrk.toFixed(3);

                let Cm1 = ( 4 * 0.8 * Q * Math.pow(10, 6) ) / ( ( Math.pow(Derk, 2) - Math.pow(Dirk, 2) ) * Math.PI );
                let Cmo = 0.65 * Cm1;
                Lcek = ( 0.8 * Q ) / ( 0.9 * Derk * Math.PI * Cmo );
                document.getElementById("Lcek").innerHTML = Lcek.toFixed(3);

                Npk = ( 2170 - ( 1.2 * Ns) ) / 250;
                document.getElementById("Npk").innerHTML = Npk.toFixed(3);
            }
            else if(document.getElementById("turbMichellBlank").checked){
                turbinaNome = "Michell-Blank";
                document.getElementById('turbReport').innerHTML = "Turbine choosen: Michell-Blank";
                let Derm, Dirm, Dim, Vim, Dmrm, Ejim, Varm, Vtm, Lrm, Npm, Lpm, Apm, Epm, Ppm;

                Derm = 38 * ( ( 1000 * Math.sqrt(H) ) / Ns );
                document.getElementById("Derm").innerHTML = Derm.toFixed(3);

                Dirm = 0.66 * Derm;
                document.getElementById("Dirm").innerHTML = Dirm.toFixed(3);

                Vim = 0.965 * Math.sqrt( 2 * 9.8 * H);
                document.getElementById("Vim").innerHTML = Vim.toFixed(3);

                Dim = 1000 * Math.sqrt( ( 4 * Q) / ( Vim * Math.PI ));
                document.getElementById("Dim").innerHTML = Dim.toFixed(3);

                Dmrm = ( Dirm + Derm ) / 2;
                document.getElementById("Dmrm").innerHTML = Dmrm.toFixed(3);

                let Ka, O;
                if(document.getElementById("60").checked){
                    Ka = 0.1443;
                    O = 60;
                }
                else if(document.getElementById("90").checked){
                    Ka = 0.2164;
                    O = 90;
                }
                else if(document.getElementById("120").checked){
                    Ka = 0.2886;
                    O = 120
                }
                Ejim = Ka * Derm;
                document.getElementById("Ejim").innerHTML = Ejim.toFixed(3);

                Vtm = 2.1 * Math.sqrt(H);
                document.getElementById("Vtm").innerHTML = Vtm.toFixed(3);

                Varm = 1000 * ( ( 60 * Vtm) / ( Derm * Math.PI ) );
                document.getElementById("Varm").innerHTML = Varm.toFixed(3);

                Lrm = 98.8 * ( Q / ( Derm * Math.sqrt(H) ) ) * ( 1000 / O);
                document.getElementById("Lrm").innerHTML = Lrm;

                Lpm = 2.8 * Dim;
                document.getElementById("Lpm").innerHTML = Lpm.toFixed(3);

                Apm = 3 * Dim;
                document.getElementById("Apm").innerHTML = Apm.toFixed(3);

                Epm = 0.8 * Dim;
                document.getElementById("Epm").innerHTML = Epm.toFixed(3);

                Ppm = Apm / 4.5;
                document.getElementById("Ppm").innerHTML = Ppm.toFixed(3);

                Npm = ( Math.PI * Derm ) / Ppm;
                document.getElementById("Npm").innerHTML = Npm.toFixed(3);
            }

            tab_Nome = document.getElementsByClassName("resultado");
            for (i = 0; i < tab_Nome.length; i++) {
                tab_Nome[i].style.display = "none";
            }
            document.getElementById(turbinaNome).style.display = "block";

        }
    </script>
</html>